<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Palette Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #ffffff;
            color: #333333;
            line-height: 1.5;
        }

        .container {
            padding: 20px;
            max-width: 100%;
        }

        .header {
            text-align: center;
            margin-bottom: 24px;
        }

        .header h1 {
            font-size: 20px;
            font-weight: 600;
            color: #000000;
            margin-bottom: 8px;
        }

        .header p {
            font-size: 14px;
            color: #666666;
        }

        .instructions {
            background: #f5f5f5;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 24px;
        }

        .instructions h3 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #000000;
        }

        .instructions ol {
            font-size: 13px;
            color: #666666;
            padding-left: 20px;
        }

        .instructions li {
            margin-bottom: 4px;
        }

        .settings {
            margin-bottom: 24px;
        }

        .setting-group {
            margin-bottom: 16px;
        }

        .setting-group label {
            display: block;
            font-size: 13px;
            font-weight: 500;
            margin-bottom: 8px;
            color: #000000;
        }

        .setting-group select,
        .setting-group input[type="range"] {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            font-size: 13px;
            background: #ffffff;
        }

        .setting-group select:focus,
        .setting-group input[type="range"]:focus {
            outline: none;
            border-color: #18a0fb;
            box-shadow: 0 0 0 2px rgba(24, 160, 251, 0.2);
        }

        .toggle-group {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .toggle-switch {
            position: relative;
            width: 44px;
            height: 24px;
            background: #e0e0e0;
            border-radius: 12px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .toggle-switch.active {
            background: #18a0fb;
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: #ffffff;
            border-radius: 50%;
            transition: transform 0.3s;
        }

        .toggle-switch.active::after {
            transform: translateX(20px);
        }

        .actions {
            display: flex;
            gap: 12px;
        }

        .btn {
            flex: 1;
            padding: 12px 16px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: #18a0fb;
            color: #ffffff;
        }

        .btn-primary:hover {
            background: #0d8ce0;
        }

        .btn-primary:active {
            background: #0b7bc7;
        }

        .btn-secondary {
            background: #f5f5f5;
            color: #666666;
        }

        .btn-secondary:hover {
            background: #e8e8e8;
        }

        .btn-secondary:active {
            background: #dcdcdc;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .status {
            margin-top: 16px;
            padding: 12px;
            border-radius: 6px;
            font-size: 13px;
            text-align: center;
            display: none;
        }

        .status.success {
            background: #e8f5e8;
            color: #2d5a2d;
            border: 1px solid #c3e6c3;
        }

        .status.error {
            background: #ffe8e8;
            color: #5a2d2d;
            border: 1px solid #e6c3c3;
        }

        .status.info {
            background: #e8f0ff;
            color: #2d4a5a;
            border: 1px solid #c3d6e6;
        }

        .progress {
            margin-top: 16px;
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: #f0f0f0;
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #18a0fb;
            width: 0%;
            transition: width 0.3s;
        }

        /* New styles for harmony checkboxes */
        .harmony-checkboxes {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 8px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 13px;
            color: #333333;
            line-height: 1.4;
            min-height: 20px;
        }

        .checkbox-item input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }

        .checkmark {
            height: 18px;
            width: 18px;
            background-color: #e0e0e0;
            border-radius: 3px;
            margin-right: 12px;
            display: inline-block;
            transition: background-color 0.3s;
            flex-shrink: 0;
            position: relative;
            vertical-align: middle;
        }

        .checkbox-item input:checked ~ .checkmark {
            background-color: #18a0fb;
        }

        .checkmark:after {
            content: "";
            display: none;
            position: absolute;
            top: 2px;
            left: 6px;
            width: 5px;
            height: 10px;
            border: solid white;
            border-width: 0 3px 3px 0;
            transform: rotate(45deg);
        }

        .checkbox-item input:checked ~ .checkmark:after {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸŽ¨ Palette Generator</h1>
            <p>Generate systematic color palettes from your moodboards</p>
        </div>

        <div class="instructions">
            <h3>How to use:</h3>
            <ol>
                <li>Select either:
                    <ul style="margin-top: 8px; margin-left: 20px;">
                        <li><strong>A frame</strong> containing multiple moodboard images, or</li>
                        <li><strong>A single image</strong> rectangle for quick palette generation</li>
                    </ul>
                </li>
                <li>Configure your palette settings below</li>
                <li>Click "Generate Palette" to create your color system</li>
            </ol>
        </div>

        <div class="settings">
            <div class="setting-group">
                <label for="scaleSteps">Color Scale Steps:</label>
                <select id="scaleSteps">
                    <option value="5">5 steps (quick)</option>
                    <option value="9" selected>9 steps (000-900)</option>
                    <option value="13">13 steps (detailed)</option>
                </select>
            </div>

            <div class="setting-group">
                <label for="accessibility">WCAG Accessibility:</label>
                <div class="toggle-group">
                    <span>Enable contrast checking</span>
                    <div class="toggle-switch" id="accessibilityToggle">
                        <input type="checkbox" id="accessibilityCheck" style="display: none;">
                    </div>
                </div>
            </div>

            <div class="setting-group">
                <label for="harmonyTypes">Harmony Types:</label>
                <div class="harmony-checkboxes">
                    <label class="checkbox-item">
                        <input type="checkbox" id="analogous" value="analogous" checked>
                        <span class="checkmark"></span>
                        Analogous Colors
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="complementary" value="complementary" checked>
                        <span class="checkmark"></span>
                        Complementary Colors
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="triadic" value="triadic" checked>
                        <span class="checkmark"></span>
                        Triadic Colors
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="splitComplementary" value="splitComplementary" checked>
                        <span class="checkmark"></span>
                        Split-Complementary Colors
                    </label>
                </div>
            </div>
        </div>

        <div class="actions">
            <button class="btn btn-primary" id="generateBtn">Generate Palette</button>
            <button class="btn btn-secondary" id="cancelBtn">Cancel</button>
        </div>

        <div class="status" id="status"></div>

        <div class="progress" id="progress">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>
    </div>

    <script>
        // Toggle switch functionality
        const accessibilityToggle = document.getElementById('accessibilityToggle');
        const accessibilityCheck = document.getElementById('accessibilityCheck');

        accessibilityToggle.addEventListener('click', () => {
            accessibilityCheck.checked = !accessibilityCheck.checked;
            accessibilityToggle.classList.toggle('active', accessibilityCheck.checked);
        });

        // Button event handlers
        document.getElementById('generateBtn').addEventListener('click', () => {
            const settings = {
                scaleSteps: parseInt(document.getElementById('scaleSteps').value),
                accessibility: accessibilityCheck.checked,
                harmonyTypes: Array.from(document.querySelectorAll('.checkbox-item input:checked')).map(input => input.value)
            };

            // Send message to plugin
            parent.postMessage({ 
                pluginMessage: { 
                    type: 'generate-palette',
                    settings: settings
                }
            }, '*');

            // Show progress
            showProgress();
            showStatus('Generating palette...', 'info');
        });

        document.getElementById('cancelBtn').addEventListener('click', () => {
            parent.postMessage({ 
                pluginMessage: { 
                    type: 'cancel'
                }
            }, '*');
        });

        // Utility functions
        function showStatus(message, type) {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `status ${type}`;
            status.style.display = 'block';
        }

        function showProgress() {
            const progress = document.getElementById('progress');
            progress.style.display = 'block';
            
            // Simulate progress
            let width = 0;
            const progressFill = document.getElementById('progressFill');
            const interval = setInterval(() => {
                width += Math.random() * 15;
                if (width >= 100) {
                    width = 100;
                    clearInterval(interval);
                }
                progressFill.style.width = width + '%';
            }, 200);
        }

        // Listen for messages from the plugin
        window.addEventListener('message', (event) => {
            const message = event.data.pluginMessage;
            
            if (message && message.type === 'palette-generated') {
                showStatus('Palette generated successfully!', 'success');
                document.getElementById('progress').style.display = 'none';
            } else if (message && message.type === 'error') {
                showStatus(message.message || 'An error occurred', 'error');
                document.getElementById('progress').style.display = 'none';
            }
        });
    </script>
</body>
</html>
